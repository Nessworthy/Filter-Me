/**
 * FilterMe - A framework for filtering stuff using jQuery.
 * 
 * Documentation and examples found at:
 * https://github.com/Nessworthy/Filter-Me
 * 
 * @author Sean Nessworthy
 * @version 0.3 (Guinea Pig)
 * @requires jQuery
 * 
 * @param args The arguments used to configure / tailor your filter. See the documentation for more info.
 */
(function(a){"use strict";a.fn.filterMe=function(b){function e(b){return a(b).attr(c.prefix)}function f(b){var g,e=a(b).attr(c.filter_type),f=!1;return e&&e.length?(e=d.filter_types[e],e.length||(f=!0)):f=!0,g=f===!0?d.filter_types[c.default_filter_type]:e}function g(b){var c=a(b).val();return c.length||(c=null),c}function h(a){return a[d.active_filter_keys.filter_type]}function i(a){return a[d.active_filter_keys.filter_value]}function j(a,b){var m,j=e(b),k=g(b),l=f(b);return a[j]&&i(a[j])===k&&h(a[j])===l?a:(m=c.multi_filter===!0?a:{},m[j]={},m[j][d.active_filter_keys.filter_value]=k,m[j][d.active_filter_keys.filter_type]=l,c.filter_callback(b,a,m),m)}function k(b,d){var f=[];return a.each(d,function(a){f.push("["+c.target_prefix+a+"]")}),a(b).find(f.join(", "))}function l(b,e){var f=k(b,e),g=[],h=[];f.each(function(){var b=this,f=!0,j={},k={};a.each(e,function(a,d){i(d)&&(k[a]=!1,j[a]=b.attributes[c.target_prefix+a].value.split(c.value_separator))}),a.each(j,function(b,f){var g,h;f.length&&(g=e[b][d.active_filter_keys.filter_value],h=e[b][d.active_filter_keys.filter_type],a.each(f,function(a,e){if(!k[b])if(h===d.filter_types.exact){if(e===g)return k[b]=!0,void 0}else if(h===d.filter_types.partial&&e.match(RegExp(g,c.partial_match_flags)))return k[b]=!0,void 0}))}),a.each(k,function(a,b){b||(f=!1)}),f?g.push(b):h.push(b)}),c.results_callback(g,h,f,e)}var c=a.extend({prefix:"data-filter-prefix",target_prefix:"data-filter-",value_separator:",",multi_filter:!0,check_on_start:!0,filter_type:"data-filter-type",default_filter_type:"exact",partial_match_flags:"i",results_callback:function(){},filter_callback:function(){}},b),d={filter_types:{exact:"exact",partial:"partial"},active_filter_keys:{filter_value:"value",filter_type:"type"}};return this.each(function(){var b=a(this),d={};b.on("change","["+c.prefix+"]",function(){d=j(d,this),l(b,d)}),c.check_on_start&&(b.find("["+c.prefix+"]").each(function(){d=j(d,this)}),l(b,d))}),this}})(jQuery);